
<!DOCTYPE html>
<html>
<head>
  <title>Minha Página Dinâmica</title>
</head>
<style>
  * {
    margin: 0; padding: 0;
    font-family: 'Trebuchet MS', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif;
  }
  h1 {padding: 10px;}
  p {padding: 4px; margin-bottom: 4px;}
.div {
  padding: 2px;
  color: rgb(87, 87, 87);
  margin-bottom: 2px;
}
footer {
  height: 50vh;
  display: flex;
  justify-content: center;
  align-items: center;
  margin-top: 1rem;
  background-color: rgb(204, 204, 204);
}
</style>
<body>
  <h1>Página de Teste</h1>
  <p>Conexão Planilha Google com página web hospedada no Github</p>
  <div id="conteudo"></div>
  <footer>DBox</footer>
  
  <script>
    // Substitua com sua chave de API e o ID da planilha
    const apiKey = 'AIzaSyDa_QKQD84jTfx5Yrqp4GRAGVzHFLTHEKY'; // Coloque sua chave de API aqui
    const spreadsheetId = '1rGD4twKHTabYK0givCXyjCo_9Dya8YudDbtLKx37vDc'; // Coloque o ID da sua planilha aqui
    const range = 'A2:B100'; // Intervalo da planilha que você quer acessar (exemplo: de A2 a B5)

    function carregarDados() {
      // URL para acessar os dados
      const url = `https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}/values/${range}?key=${apiKey}`;

      fetch(url)
        .then(response => response.json())
        .then(data => {
          const conteudoDiv = document.getElementById("conteudo");
          conteudoDiv.innerHTML = ''; // Limpa o conteúdo anterior

          // Loop pelos dados e exibição na página
          data.values.forEach(row => {
            const div = document.createElement('div');
            div.classList.add('div')
            div.innerHTML = `${row[0]} - ${row[1]}`;
            conteudoDiv.appendChild(div);
          });
        })
        .catch(error => {
          console.error('Erro na requisição:', error);
        });
    }

    carregarDados(); // Chama a função ao carregar a página

    setInterval(carregarDados, 5000); // Atualiza a cada 5 segundos
  </script>
</body>
</html>
